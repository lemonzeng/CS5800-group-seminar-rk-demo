<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Rabin-Karp vs Naive Search Visualizer</title>
  <style>
    body { 
      font-family: 'Segoe UI', sans-serif; 
      background: linear-gradient(135deg, #ffc0cb 0%, #ffb6c1 25%, #ffd1dc 50%, #ffb3d9 75%, #ffc0cb 100%);
      color: #4a1942; 
      text-align: center; 
      padding: 2rem;
      min-height: 100vh;
    }
    h1 { 
      color: #d946ef; 
      font-size: 2.5rem;
      text-shadow: 2px 2px 4px rgba(255,255,255,0.5);
      margin-bottom: 1rem;
    }
    .subtitle {
      color: #7c2d89;
      font-size: 1.2rem;
      margin-bottom: 2rem;
    }
    .input-section {
      background: rgba(255, 255, 255, 0.7);
      backdrop-filter: blur(10px);
      border-radius: 1rem;
      padding: 1.5rem;
      margin: 2rem auto;
      max-width: 800px;
      box-shadow: 0 8px 32px rgba(217, 70, 239, 0.2);
    }
    label {
      font-weight: 600;
      color: #7c2d89;
      margin: 0 1rem;
      font-size: 1.1rem;
    }
    input {
      padding: 0.5rem;
      border: 2px solid #d946ef;
      border-radius: 0.5rem;
      font-size: 1rem;
      margin: 0.5rem;
      background: white;
    }
    .container { 
      display: flex; 
      justify-content: center; 
      gap: 2rem; 
      margin-top: 2rem; 
      flex-wrap: wrap;
    }
    .panel { 
      background: rgba(255, 255, 255, 0.85);
      backdrop-filter: blur(10px);
      border-radius: 1rem; 
      padding: 1.5rem; 
      width: 40%; 
      min-width: 350px;
      box-shadow: 0 8px 32px rgba(217, 70, 239, 0.3);
      border: 2px solid rgba(217, 70, 239, 0.3);
    }
    .panel h2 {
      color: #a855f7;
      margin-bottom: 1rem;
      font-size: 1.8rem;
    }
    .text-area { 
      font-family: 'Courier New', monospace; 
      white-space: pre-wrap;
      word-wrap: break-word;
      background: rgba(255, 240, 250, 0.8);
      padding: 1rem; 
      border-radius: 0.5rem; 
      min-height: 5rem;
      border: 2px solid #f0abfc;
      font-size: 1.1rem;
      line-height: 1.6;
    }
    .highlight { 
      background: #22c55e; 
      color: white; 
      font-weight: bold;
      padding: 2px 4px;
      border-radius: 3px;
    }
    .window { 
      background: #fbbf24; 
      color: #78350f; 
      font-weight: bold;
      padding: 2px 4px;
      border-radius: 3px;
    }
    button { 
      background: linear-gradient(135deg, #d946ef, #a855f7);
      color: white; 
      border: none; 
      border-radius: 0.5rem; 
      padding: 1rem 2.5rem; 
      cursor: pointer; 
      font-size: 1.2rem;
      font-weight: bold;
      box-shadow: 0 4px 15px rgba(217, 70, 239, 0.4);
      transition: all 0.3s ease;
    }
    button:hover { 
      background: linear-gradient(135deg, #c026d3, #9333ea);
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(217, 70, 239, 0.6);
    }
    button:disabled {
      background: #cbd5e1;
      cursor: not-allowed;
      transform: none;
    }
    #results { 
      margin-top: 2rem; 
      font-size: 1.3rem;
      background: rgba(255, 255, 255, 0.8);
      backdrop-filter: blur(10px);
      padding: 1.5rem;
      border-radius: 1rem;
      max-width: 800px;
      margin: 2rem auto;
      box-shadow: 0 8px 32px rgba(217, 70, 239, 0.3);
    }
    .speed { 
      color: #22c55e; 
      font-weight: bold;
    }
    .race { 
      display: flex; 
      justify-content: center; 
      align-items: center; 
      gap: 2rem; 
      margin-top: 2rem;
      flex-wrap: wrap;
    }
    .race-item {
      flex: 1;
      min-width: 300px;
      max-width: 400px;
    }
    .race-label {
      font-weight: bold;
      margin-bottom: 0.5rem;
      font-size: 1.1rem;
      color: #7c2d89;
    }
    .bar-container { 
      background: rgba(255, 255, 255, 0.6);
      border-radius: 1rem; 
      overflow: hidden; 
      height: 2rem;
      border: 2px solid rgba(217, 70, 239, 0.3);
      box-shadow: inset 0 2px 4px rgba(0,0,0,0.1);
    }
    .bar { 
      height: 100%; 
      width: 0%; 
      transition: width 0.1s linear;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-weight: bold;
      font-size: 0.9rem;
    }
    .bar.naive { 
      background: linear-gradient(90deg, #f87171, #ef4444);
    }
    .bar.rk { 
      background: linear-gradient(90deg, #22c55e, #16a34a);
    }
    .winner {
      font-size: 1.5rem;
      font-weight: bold;
      color: #d946ef;
      margin-top: 1rem;
      animation: pulse 1s infinite;
    }
    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.7; }
    }
  </style>
</head>
<body>
  <h1>‚ö° Rabin-Karp vs Naive Search</h1>
  <p class="subtitle">Watch both algorithms race simultaneously!</p>
  
  <div class="input-section">
    <div style="margin-bottom: 1rem;">
      <label>Text: 
        <input id="textInput" size="40" value="ABABABABABAAAAACCCCCABABBBAABBAABABBA" />
      </label>
    </div>
    <div>
      <label>Pattern: 
        <input id="patternInput" size="15" value="ABA" />
      </label>
      <button id="startBtn">üöÄ Start Race</button>
    </div>
  </div>

  <div class="race">
    <div class="race-item">
      <div class="race-label">Naive Search Progress</div>
      <div class="bar-container">
        <div class="bar naive" id="naiveBar"></div>
      </div>
    </div>
    <div class="race-item">
      <div class="race-label">Rabin-Karp Progress</div>
      <div class="bar-container">
        <div class="bar rk" id="rkBar"></div>
      </div>
    </div>
  </div>

  <div class="container">
    <div class="panel" id="naivePanel">
      <h2>üêå Naive Search</h2>
      <div class="text-area" id="naiveText"></div>
    </div>
    <div class="panel" id="rkPanel">
      <h2>üöÄ Rabin-Karp Search</h2>
      <div class="text-area" id="rkText"></div>
    </div>
  </div>

  <div id="results"></div>

  <script>
    const delay = ms => new Promise(r => setTimeout(r, ms));
    
    // Different delays for different operations
    const HASH_CHECK_DELAY = 80;      // Fast - hash comparison is O(1)
    const CHAR_COMPARE_DELAY = 40;    // Per character comparison
    const MATCH_FOUND_DELAY = 120;    // Pause when match is found

    async function visualize() {
      const text = document.getElementById('textInput').value;
      const pattern = document.getElementById('patternInput').value;
      const n = text.length, m = pattern.length;
      const naiveEl = document.getElementById('naiveText');
      const rkEl = document.getElementById('rkText');
      const resultsEl = document.getElementById('results');
      const naiveBar = document.getElementById('naiveBar');
      const rkBar = document.getElementById('rkBar');
      const startBtn = document.getElementById('startBtn');
      
      startBtn.disabled = true;
      resultsEl.innerHTML = '<p>üèÅ Race in progress...</p>';
      naiveBar.style.width = rkBar.style.width = '0%';
      naiveBar.textContent = rkBar.textContent = '';

      function render(el, pos, matchPos=-1) {
        let html='';
        for(let i=0;i<n;i++) {
          if(i===pos) {
            html+='<span class="window">'+text.slice(i,i+m)+'</span>';
            i += m - 1;
          } else if(i===matchPos) {
            html+='<span class="highlight">'+text.slice(i,i+m)+'</span>';
            i += m - 1;
          } else {
            html+=text[i];
          }
        }
        el.innerHTML=html;
      }

      // Run both algorithms in parallel
      const [naiveResult, rkResult] = await Promise.all([
        runNaive(),
        runRabinKarp()
      ]);

      // Naive Search - must compare all characters at each position
      async function runNaive() {
        let start = performance.now();
        let matches = [];
        
        for(let i=0; i<=n-m; i++) {
          render(naiveEl, i);
          const progress = ((i/(n-m))*100).toFixed(1);
          naiveBar.style.width = progress + '%';
          naiveBar.textContent = progress + '%';
          
          // Naive always does character-by-character comparison
          // Simulate comparing m characters (slower)
          await delay(CHAR_COMPARE_DELAY * m);
          
          if(text.slice(i,i+m) === pattern) {
            matches.push(i);
            render(naiveEl, -1, i);
            await delay(MATCH_FOUND_DELAY);
          }
        }
        
        naiveBar.style.width = '100%';
        naiveBar.textContent = '100%';
        let end = performance.now();
        
        return {
          matches: matches,
          time: end - start
        };
      }

      // Rabin-Karp Search - hash check is fast, verification is slow
      async function runRabinKarp() {
        let start = performance.now();
        let base = 256, mod = 101;
        let h = 1;
        
        for(let i=0; i<m-1; i++) {
          h = (h * base) % mod;
        }
        
        let p = 0, t = 0;
        for(let i=0; i<m; i++) {
          p = (base * p + pattern.charCodeAt(i)) % mod;
          t = (base * t + text.charCodeAt(i)) % mod;
        }
        
        let matches = [];
        
        for(let i=0; i<=n-m; i++) {
          render(rkEl, i);
          const progress = ((i/(n-m))*100).toFixed(1);
          rkBar.style.width = progress + '%';
          rkBar.textContent = progress + '%';
          
          // Hash check is fast O(1)
          await delay(HASH_CHECK_DELAY);
          
          if(p === t) {
            // Hash matches - need to verify with character comparison
            await delay(CHAR_COMPARE_DELAY * m);
            if(text.slice(i,i+m) === pattern) {
              matches.push(i);
              render(rkEl, -1, i);
              await delay(MATCH_FOUND_DELAY);
            }
          }
          // If hash doesn't match, skip verification - this is the advantage!
          
          if(i < n-m) {
            t = (base * (t - text.charCodeAt(i) * h) + text.charCodeAt(i+m)) % mod;
            if(t < 0) t += mod;
          }
        }
        
        rkBar.style.width = '100%';
        rkBar.textContent = '100%';
        let end = performance.now();
        
        return {
          matches: matches,
          time: end - start
        };
      }

      // Display results
      const naiveTime = naiveResult.time.toFixed(1);
      const rkTime = rkResult.time.toFixed(1);
      const ratio = (naiveResult.time / rkResult.time).toFixed(2);
      
      let winner = '';
      if (rkResult.time < naiveResult.time) {
        winner = '<div class="winner">üèÜ Rabin-Karp Wins!</div>';
      } else if (rkResult.time > naiveResult.time) {
        winner = '<div class="winner">üèÜ Naive Wins!</div>';
      } else {
        winner = '<div class="winner">ü§ù It\'s a Tie!</div>';
      }

      resultsEl.innerHTML = `
        <p>
          <strong>Naive Search:</strong> Found <b>${naiveResult.matches.length}</b> matches in <span class='speed'>${naiveTime}ms</span><br>
          <strong>Rabin-Karp:</strong> Found <b>${rkResult.matches.length}</b> matches in <span class='speed'>${rkTime}ms</span><br>
          <strong>Speedup:</strong> ${ratio}√ó faster
        </p>
        ${winner}
      `;
      
      startBtn.disabled = false;
    }

    document.getElementById('startBtn').addEventListener('click', () => visualize());
  </script>
</body>
</html>
